<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Bible API (Python)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Public domain Bible JSON API (FastAPI)">
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <style>
      :root { --bg:#f7f7f7; --panel:#ffffff; --border:#d8d8d8; --accent:#304674; --mono:#222; }
      body { font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; margin:0; background:var(--bg); color:#222; line-height:1.5; }
      header { background:#18263a; color:#fff; padding:1.25rem 1rem; }
      header h1 { margin:0; font-size:1.6rem; }
      header nav a { color:#c9ddff; margin-right:1rem; text-decoration:none; font-size:0.95rem; }
      header nav a:hover { text-decoration:underline; }
      main { max-width:1200px; margin:0 auto; padding:1.5rem 1rem 3rem; }
      h2 { margin-top:2.2rem; }
      pre, code { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:0.9rem; }
      table { border-collapse: collapse; width:100%; margin:0.75rem 0 1.5rem; }
      th, td { text-align:left; border:1px solid var(--border); padding:6px 8px; }
      th { background:#eef2f7; }
      .grid { display:grid; gap:1.25rem; }
      @media (min-width: 980px) { .grid.two { grid-template-columns:1fr 1fr; } }
      section.panel { background:var(--panel); padding:1rem 1.25rem 1.25rem; border:1px solid var(--border); border-radius:6px; }
      .small { font-size:0.83rem; color:#555; }
      a { color:var(--accent); }
      .translations-table td a { font-weight:600; }
      footer { margin-top:3rem; font-size:0.75rem; color:#555; text-align:center; }
      .badge { display:inline-block; background:#304674; color:#fff; padding:2px 6px; font-size:0.65rem; border-radius:4px; margin-left:6px; vertical-align:middle; }
      .nowrap { white-space:nowrap; }
    </style>
  </head>
  <body>
    <header>
      <h1>Bible API (Python Port)</h1>
      <nav aria-label="Primary">
        <a href="/docs" rel="noopener">OpenAPI Docs</a>
        <a href="/redoc" rel="noopener">ReDoc</a>
        <a href="https://github.com/andreidemit/bible_api" rel="noopener">Source</a>
      </nav>
    </header>
    <main role="main">
      <p>This service provides a JSON API for retrieving Bible verses and passages from <strong>public domain</strong> translations. It is a Python (FastAPI) port of the original Ruby project by Tim Morgan, now reading XML directly from Azure Blob Storage.</p>

      <div class="grid two" aria-label="API styles">
        <section class="panel" aria-labelledby="user-input-api">
          <h2 id="user-input-api">User Input API</h2>
          <p>Accepts natural-style references. Pattern (book + chapter:verse). You may use a space or <code>+</code> between book and chapter (space will be URL encoded):</p>
          <pre><code>{{ host }}/BOOK+CHAPTER:VERSE</code></pre>
          <table aria-label="Free-form examples">
            <thead><tr><th>Description</th><th>Link</th></tr></thead>
            <tbody>
              <tr><td>Single verse</td><td><a href="/john+3:16">john+3:16</a></td></tr>
              <tr><td>Abbreviated book</td><td><a href="/jn+3:16">jn+3:16</a></td></tr>
              <tr><td>Multiple ranges (same chapter)</td><td><a href="/matt+25:31-33,46">matt+25:31-33,46</a></td></tr>
              <tr><td>Show verse numbers</td><td><a href="/john+3:16?verse_numbers=true">john+3:16?verse_numbers=true</a></td></tr>
            </tbody>
          </table>
          <p>Specify a translation via <code>?translation=&lt;id&gt;</code>. Example (default "web"): <a href="/john+3:16?translation=web">/john+3:16?translation=web</a></p>
          <h3>Single-Chapter Books</h3>
          <p>Books like Jude and Obadiah match verse 1 when you request <code>jude 1</code>. A future parameter <code>?single_chapter_book_matching=indifferent</code> is reserved to force whole-chapter matching (currently no effect).</p>
        </section>
        <section class="panel" aria-labelledby="param-api">
          <h2 id="param-api">Structured API</h2>
          <p>Deterministic endpoints keyed by translation, book, and chapter.</p>
          <pre><code>{{ api_base }}/data/{TRANSLATION_ID}/{BOOK_ID}/{CHAPTER}</code></pre>
          <table aria-label="Structured examples">
            <thead><tr><th>Description</th><th>Link</th></tr></thead>
            <tbody>
              <tr><td>Translations</td><td><a href="{{ api_base }}/data">{{ api_base }}/data</a></td></tr>
              <tr><td>Books in default translation</td><td><a href="{{ api_base }}/data/web">{{ api_base }}/data/web</a></td></tr>
              <tr><td>Chapters in John</td><td><a href="{{ api_base }}/data/web/JHN">{{ api_base }}/data/web/JHN</a></td></tr>
              <tr><td>Verses in John 3</td><td><a href="{{ api_base }}/data/web/JHN/3">{{ api_base }}/data/web/JHN/3</a></td></tr>
            </tbody>
          </table>
          <h3>Random Verse</h3>
            <p>Use <code>/data/&lt;translation&gt;/random</code> optionally followed by <code>/OT</code>, <code>/NT</code>, a single book id, or a comma list (e.g. <code>/MAT,MRK,LUK,JHN</code>).</p>
            <table aria-label="Random examples">
              <thead><tr><th>Description</th><th>Link</th></tr></thead>
              <tbody>
                <tr><td>Any book</td><td><a href="{{ api_base }}/data/web/random">{{ api_base }}/data/web/random</a></td></tr>
                <tr><td>Specific book (John)</td><td><a href="{{ api_base }}/data/web/random/JHN">{{ api_base }}/data/web/random/JHN</a></td></tr>
                <tr><td>Multiple books</td><td><a href="{{ api_base }}/data/web/random/MAT,MRK,LUK,JHN">{{ api_base }}/data/web/random/MAT,MRK,LUK,JHN</a></td></tr>
                <tr><td>Old Testament</td><td><a href="{{ api_base }}/data/web/random/OT">{{ api_base }}/data/web/random/OT</a></td></tr>
                <tr><td>New Testament</td><td><a href="{{ api_base }}/data/web/random/NT">{{ api_base }}/data/web/random/NT</a></td></tr>
              </tbody>
            </table>
        </section>
      </div>

      <h2 id="translations">Translations</h2>
      <p>Public domain translations currently available:</p>
      <table class="translations-table" aria-label="Translations table">
        <thead>
          <tr><th>Language</th><th>Name</th><th>Identifier / Example</th></tr>
        </thead>
        <tbody>
        {% for t in translations %}
          <tr>
            <td>{{ t.language }}</td>
            <td>{{ t.name }}</td>
            <td class="nowrap">
              <a href="/{{ example_books[t.identifier] }}+3:16?translation={{ t.identifier }}">{{ t.identifier }}</a>
              {% if loop.first %}<span class="badge">default</span>{% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
      <p>Want to add more? Provide a public domain XML text and list it in <code>DATA_LICENSES.md</code>.</p>

      <h2 id="docs">Developer Resources</h2>
      <ul>
        <li><a href="/docs">OpenAPI (Swagger UI)</a></li>
        <li><a href="/redoc">ReDoc Spec</a></li>
        <li><a href="https://github.com/andreidemit/bible_api">GitHub Repository</a></li>
        <li><a href="/healthz">Health Check</a></li>
      </ul>

      <h2 id="cors">CORS</h2>
      <p>CORS is enabled for GET requests, enabling frontend JavaScript integration.</p>

      <h2 id="terms">Usage & Terms</h2>
      <p>Be respectful—avoid bulk dumping. Fetching an entire translation repeatedly is discouraged; retrieve the XML from its original public domain source if you need full corpus processing.</p>
      <p>No warranty; service availability is best-effort. Host your own instance (Docker supported) for production reliability.</p>

      <h2 id="attribution">Attribution</h2>
      <p>Original concept & Ruby implementation by Tim Morgan (MIT). Python FastAPI port and Azure XML adaptation by Andrei Demit. See <code>LICENSE</code>, <code>NOTICE</code>, and <code>DATA_LICENSES.md</code>.</p>
    </main>
    <footer>
      &copy; {{  ( (now|default('')) ) }} Bible API – Public Domain Data · MIT Licensed Code
    </footer>
  </body>
</html>